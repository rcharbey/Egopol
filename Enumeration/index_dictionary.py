DICT = [
    {   "[1]":(1,1,[(1,1)]) #0
    },
    {
        "[1]":(2,2,[(1,2)]), #1
        "[1, 1]":(3,1,[(1,1)])
    },
    {
        "[2]":(4,1,[(3,3),(2,4)]), #2
        "[2, 2]":(7,1,[(1,1),(2,2)]),
        "[1]":(5,2,[(1,1),(2,2)]),
        "[1, 2]":(6,1,[(2,2),(1,3)]),
        "[1, 2, 2]":(8,2,[(2,2),(1,1)])
    },
    {
        "[1]":(6,3,[(2,1)]), #3
        "[1, 1]":(8,1,[(2,1)]),
        "[1, 1, 1]":(9,1,[(1,1)])
    },
    {
        "[4]":(10,5,[(1,1),(2,2),(3,3),(4,4)]), #4
        "[3]":(12,2,[(4,4),(3,3),(5,5),(2,2)]),
        "[3, 4]":(13,1,[(4,4),(3,3),(2,2),(1,1)]),
        "[2]":(12,2,[(2,2),(1,1),(3,3),(4,4)]),
        "[2, 4]":(17,3,[(1,1),(2,2),(3,3),(4,4)]),
        "[2, 3]":(14,3,[(1,1),(2,2),(4,4),(5,5)]),
        "[2, 3, 4]":(18,3,[(1,1),(2,2),(3,3),(4,4)]),
        "[1]":(10,1,[(2,2),(3,3),(4,4),(5,5)]),
        "[1, 4]":(16,5,[(1,1),(2,2),(3,3),(4,4)]),
        "[1, 3]":(17,3,[(4,4),(3,3),(2,2),(5,5)]),
        "[1, 3, 4]":(21,2,[(4,4),(5,5),(3,3),(1,1)]),
        "[1, 2]":(13,1,[(1,1),(2,2),(3,3),(4,4)]),
        "[1, 2, 4]":(21,2,[(1,1),(3,3),(5,5),(4,4)]),
        "[1, 2, 3]":(18,3,[(4,4),(3,3),(2,2),(1,1)]),
        "[1, 2, 3, 4]":(24,5,[(1,1),(2,2),(3,3),(4,4)])
    },
    {
        "[2]":(12,4,[(1,1),(3,2)]), #5
        "[2, 2]":(17,4,[(2,2),(3,1)]),
        "[2, 2, 2]":(22,1,[(2,2),(1,1)]),
        "[1]":(11,2,[(1,1),(2,2)]),
        "[1, 2]":(15,2,[(3,3),(1,2)]),
        "[1, 2, 2]":(19,4,[(2,2),(3,1)]),
        "[1, 2, 2, 2]":(25,1,[(1,1),(2,2)])
    },
    {
        "[3]":(13,4,[(1,1),(2,2),(3,3)]), #6
        "[2]":(15,2,[(1,1),(3,3),(2,2)]),
        "[2, 3]":(20,3,[(1,1),(2,2),(3,3)]),
        "[1]":(14,1,[(2,3),(4,4),(5,5)]),
        "[1, 3]":(21,5,[(3,1),(2,2),(4,4)]),
        "[1, 2]":(19,3,[(4,3),(2,2),(1,1)]),
        "[1, 2, 3]":(24,3,[(2,1),(5,5),(4,4)]),
        "[1, 1]":(18,4,[(3,3),(2,2),(1,1)]),
        "[1, 1, 3]":(26,2,[(3,3),(2,2),(1,1)]),
        "[1, 1, 2]":(23,3,[(3,3),(2,2),(1,1)]),
        "[1, 1, 2, 3]":(28,3,[(2,2),(3,3),(1,1)])
    },
    {
        "[2]":(17,1,[(3,3),(2,4)]), #7
        "[2, 2]":(22,1,[(1,1),(2,2)]),
        "[1]":(17,1,[(2,4),(3,3)]),
        "[1, 2]":(21,1,[(2,5),(3,4)]),
        "[1, 2, 2]":(26,3,[(3,1),(2,2)]),
        "[1, 1]":(22,1,[(2,2),(1,1)]),
        "[1, 1, 2]":(26,3,[(2,2),(3,1)]),
        "[1, 1, 2, 2]":(27,3,[(1,1),(2,2)])
    },
    {
        "[2]":(19,1,[(3,3),(2,4)]), #8
        "[2, 2]":(25,2,[(2,2),(1,1)]),
        "[1]":(18,1,[(2,4),(3,3)]),
        "[1, 2]":(24,4,[(3,1),(2,3)]),
        "[1, 2, 2]":(28,2,[(2,1),(3,3)]),
        "[1, 1]":(26,1,[(2,2),(3,3)]),
        "[1, 1, 2]":(27,1,[(2,2),(3,1)]),
        "[1, 1, 2, 2]":(29,2,[(1,1),(2,2)])
    },
    {
        "[1]":(23,1,[(2,3)]), #9
        "[1, 1]":(28,1,[(3,2)]),
        "[1, 1, 1]":(29,1,[(2,1)]),
        "[1, 1, 1, 1]":(30,1,[(1,1)])
    }
]

def index_pattern(graph_sub, pt, ps):
    length_sub = len(graph_sub.vs)
    new_vertex = graph_sub.vs[length_sub - 1]
    new_vertex['neighbors_evol_classes'].sort()
    prev_pattern = graph_sub.vs[length_sub - 2]['pattern_sub']
    dict_temp = DICT[prev_pattern][str(new_vertex['neighbors_evol_classes'])]
    new_pattern = dict_temp[0]
    new_vertex['pattern_sub'] = new_pattern
    pt[new_pattern - 1] += 1
    for v in graph_sub.vs[0:length_sub - 1]:
        list_neighbors = [vertex['id_principal'] for vertex in new_vertex.neighbors()]
        if v['id_principal'] in list_neighbors: 
            v['evol_class'] = dict_temp[2][v['evol_class'] - 1][0]
        else:
            v['evol_class'] = dict_temp[2][v['evol_class'] - 1][1]
    new_vertex['evol_class'] = dict_temp[1]